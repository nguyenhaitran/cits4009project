---
title: "CITS4009-Individual Project"
author: "Henry Tran"
date: "2024-09-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Install all the required packages
library(ggplot2)
library(shiny)
library(gridExtra)
```

```{r}
# Read the data
path<-url("https://lms.uwa.edu.au/bbcswebdav/pid-3998436-dt-content-rid-47695412_1/courses/CITS4009_SEM-2_2024/Countries%20and%20death%20causes.csv")
```

# Data Exploratory
```{r}
data<-read.csv(path, header=TRUE)
head(data)
nrow(data)
```
The data has 31 columns and 6840 rows. For the column names, they can be seen that the column names have dot-separated between each word.

```{r}
names(data)<-gsub("\\.", "_", names(data)) #remove the dot in the column names

data
```

```{r}
str(data)
```
```{r}
summary(data)
```
For the first 2 columns, "Entity" and "Code" store different country names and codes. Therefore, to set them as a country as a unique value, it would be the best to convert them into factor

```{r}
data$Entity<-as.factor(data$Entity)
data$Code<-as.factor(data$Code)

summary(data)
str(data)
```
There are 228 unique entities but there are only 206 codes in this dataset. The reason is because there are some countries and regions do not have unique codes.

While with remaining 29 columns, the maximum numbers are extremely larger than other values. The reason is because the dataset did not only record deaths of countries, but it also recorded the total deaths in groups, regions and in the world. Therefore, if we do the data analysis on the whole dataset, it will create skewness problem. The solution for this would be we can seperated data into different groups: countries, regions and world. I have some examples of the single eda below:

```{r}
boxplot(data$High_systolic_blood_pressure)
```
```{r}
boxplot(data$Outdoor_air_pollution)
```


For data exploratory, it will be done using Shiny app

```{r}
# Define UI for application that draws different plot
ui <- fluidPage(
    titlePanel("Histogram of death in country/region during 1990 - 2019"),
    sidebarLayout(
        sidebarPanel(
            checkboxInput("compare", "Compare between 2 countries/regions", FALSE),
            selectInput("region1", "Choose country/region:", choices = unique(data$Entity)),
            selectInput("region2", "Choose country/region:", choices = unique(data$Entity)),
            selectInput("reason", "Choose death reason:", choices = names(data)[4:31]),
        ),
        mainPanel(plotOutput("plot1"), plotOutput("plot2"))
    )
)


# Define the server
server <- function(input, output){
    # Render the histograms
  if (input$compare){
    output$plot1 <- renderPlot({
      region_data<-data[data$Entity==input$region1,]
      # Plot all death reasons
      ggplot(region_data, aes_string(x="Year", y=input$reason)) + geom_line(color="blue") + labs(x="Year", y = input$reason)
    })
  } else{
    output$plot1 <- renderPlot({
      region_data<-data[data$Entity==input$region1,]
      # Plot all death reasons
      ggplot(region_data, aes_string(x="Year", y=input$reason)) + geom_line(color="blue") + labs(x="Year", y = input$reason)
    })
    output$plot2 <- renderPlot({
      region_data<-data[data$Entity==input$region2,]
      # Plot all death reasons
      ggplot(region_data, aes_string(x="Year", y=input$reason)) + geom_line(color="blue") + labs(x="Year", y = input$reason)
    })
  }
}

# Run the Shiny app
shinyApp(ui = ui, server = server)
```





