---
title: "CITS4009-Individual Project"
author: "Henry Tran"
date: "2024-09-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Install all the required packages
library(ggplot2)
library(shiny)
library(gridExtra)
```

```{r}
# Read the data
path<-url("https://lms.uwa.edu.au/bbcswebdav/pid-3998436-dt-content-rid-47695412_1/courses/CITS4009_SEM-2_2024/Countries%20and%20death%20causes.csv")
```

# Data Exploratory
```{r}
data<-read.csv(path, header=TRUE)
head(data)
nrow(data)
```
The data has 31 columns and 6840 rows. For the column names, they can be seen that the column names have dot-separated between each word.

```{r}
names(data)<-gsub("\\.", " ", names(data)) #remove the dot in the column names

data
```

```{r}
str(data)
```
```{r}
summary(data)
```
For the first 2 columns, "Entity" and "Code" store different country names and codes. Therefore, to set them as a country as a unique value, it would be the best to convert them into factor

```{r}
data$Entity<-as.factor(data$Entity)
data$Code<-as.factor(data$Code)

summary(data)
str(data)
```
There are 228 unique entities but there are only 206 codes in this dataset. The reason is because there are some countries and regions do not have unique codes.

While with remaining 29 columns, the maximum numbers are extremely larger than other values. The reason is because the dataset did not only record deaths of countries, but it also recorded the total deaths in groups, regions and in the world. 

For data exploratory, it will be done using Shiny app

```{r}
# Define UI for application that draws different plot
ui <- fluidPage(
sidebarPanel(
      selectInput("plot_type", "Select plot type:", choices = c("Pairwise", "Scatter", "Bin2d", "Hex", "Count")),
      conditionalPanel(
        condition = "input.plot_type == 'Pairwise'",
        #panel for option selection for Pairwise plot
        pickerInput(
          inputId = "selected_attributes", #link to input$selected_attributes
          label = "Select attributes:",
          choices = names(a),
          multiple = TRUE,
          options = list(`actions-box` = TRUE)
        )
      ),
      conditionalPanel(
        condition = "input.plot_type == 'Scatter' || input.plot_type=='Bin2d'|| input.plot_type=='Hex' || input.plot_type=='Count'",
        selectInput("x_attr", "Select x-axis attribute:", names(a)),
        selectInput("y_attr", "Select y-axis attribute:", names(a))
      )

        sidebarLayout(
            sidebarPanel(
                selectInput(inputId = "x1", label = "Choose X:", choices = names(df))
            ),
            mainPanel(
                plotOutput(outputId = "histogram")
            )
        )
),
mainPanel(
      plotOutput("plot",height = "400px", width = "600px")
    )
)

# in the server:
server <- function(input, output) {
  output$plot <- renderPlot({
      if (input$plot_type == "Pairwise") {
        selected_attrs <- input$selected_attributes
        if (length(selected_attrs) < 2) {
          return(NULL)
        } else{
        pairs(a[, selected_attrs])
        }
      } else if (input$plot_type == "Scatter"){
        x_attr<-input$x_attr
        y_attr<-input$y_attr
        ggplot(a, aes_string(x=x_attr, y=y_attr))+geom_point()+geom_smooth() 
      } else if (input$plot_type == "Bin2d"){
        x_attr<-input$x_attr
        y_attr<-input$y_attr
        ggplot(a, aes_string(x=x_attr, y=y_attr))+geom_bin2d()
      } else if (input$plot_type == "Bin2d"){
        x_attr<-input$x_attr
        y_attr<-input$y_attr
        ggplot(a, aes_string(x=x_attr, y=y_attr))+geom_hex(binwidth=c(min(x),max(x)))
      } else if (input$plot_type == "Count"){
        x_attr<-input$x_attr
        y_attr<-input$y_attr
        ggplot(a)+geom_count(aes_string(x=x_attr, y=y_attr), alpha = 0.25)
      }
    })
}

# Run the application 
shinyApp(ui = ui, server = server)
```





